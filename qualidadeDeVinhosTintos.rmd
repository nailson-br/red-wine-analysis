---
output: html_document
editor_options: 
  chunk_output_type: console
---
Qualidade de Vinhos Tintos por Nailson dos Santos
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Carregue aqui todos os pacotes utilizados 
# na sua análise realizada neste arquivo fonte.

# Note que o parâmetro "echo" foi definido como FALSE neste código.
# Isso previne que o código apresente resultados formatados em HTML.
# Você deve definir echo=FALSE para todos os blocos de código no seu arquivo.

library(ggplot2)
library(dplyr)
library(GGally)
library(gridExtra)
```

```{r echo=FALSE, Load_the_Data}
# Carregamento dos dados
setwd('.')

vinhos <- read.csv('wineQualityReds.csv', sep = ',')
```

# Seção de Gráficos Univariados
```{r echo=FALSE, Univariate_Plots}
p1 <- ggplot(aes(x = fixed.acidity), data = vinhos) +
    geom_histogram(binwidth = 0.2, color = 'black', fill = '#099DD9')

p2 <- ggplot(aes(x = volatile.acidity), data = vinhos) +
    geom_histogram(binwidth = 0.05, color = 'black', fill = '#099DD9')

p3 <- ggplot(aes(x = citric.acid), data = vinhos) +
    geom_histogram(binwidth = 0.05, color = 'black', fill = '#099DD9')

p4 <- ggplot(aes(x = residual.sugar), data = vinhos) +
    geom_histogram(binwidth = 0.2, color = 'black', fill = '#099DD9')

p5 <- ggplot(aes(x = chlorides), data = vinhos) +
    geom_histogram(binwidth = 0.01, color = 'black', fill = '#099DD9')

p6 <- ggplot(aes(x = free.sulfur.dioxide), data = vinhos) +
    geom_histogram(binwidth = 1, color = 'black', fill = '#099DD9')

p7 <- ggplot(aes(x = total.sulfur.dioxide), data = vinhos) +
    geom_histogram(binwidth = 5, color = 'black', fill = '#099DD9')

p8 <- ggplot(aes(x = density), data = vinhos) +
    geom_histogram(binwidth = 0.0005, color = 'black', fill = '#099DD9')

p9 <- ggplot(aes(x = pH), data = vinhos) +
    geom_histogram(binwidth = 0.02, color = 'black', fill = '#099DD9')

p10 <- ggplot(aes(x = sulphates), data = vinhos) +
    geom_histogram(binwidth = 0.05, color = 'black', fill = '#099DD9')

p11 <- ggplot(aes(x = alcohol), data = vinhos) +
    geom_histogram(binwidth = 0.2, color = 'black', fill = '#099DD9')

p12 <- ggplot(aes(x = quality), data = vinhos) +
    geom_histogram(binwidth = 1, color = 'black', fill = '#099DD9')

grid.arrange(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, ncol = 3)
```
Avaliando os gráficos gerados pode-se perceber que as variáveis **density** e **pH** têm distribuição normal.

Em contrapartida, **fixed.acidity**, **volatile.acidity**, **residual.sugar**, **chlorides**, **free.sulfur.dioxide**, **total.sulfur.dioxide** e **sulphates** têm cauda longa.
```{r}
p1 <- ggplot(aes(x = fixed.acidity), data = vinhos) +
    geom_histogram(binwidth = 0.02, color = 'black', fill = '#099DD9') +
    scale_x_log10(breaks = seq(0, 20, 1))

p2 <- ggplot(aes(x = volatile.acidity), data = vinhos) +
    geom_histogram(binwidth = 0.05, color = 'black', fill = '#099DD9') +
    scale_x_log10(breaks = seq(0.1, 1.5, 0.2))

p4 <- ggplot(aes(x = residual.sugar), data = vinhos) +
    geom_histogram(binwidth = 0.05, color = 'black', fill = '#099DD9') +
    scale_x_log10()

p5 <- ggplot(aes(x = chlorides), data = vinhos) +
    geom_histogram(binwidth = 0.05, color = 'black', fill = '#099DD9') +
    scale_x_log10()

p6 <- ggplot(aes(x = free.sulfur.dioxide), data = vinhos) +
    geom_histogram(binwidth = .05, color = 'black', fill = '#099DD9') +
    scale_x_log10()

p7 <- ggplot(aes(x = total.sulfur.dioxide), data = vinhos) +
    geom_histogram(binwidth = 0.04, color = 'black', fill = '#099DD9') +
    scale_x_log10(breaks = seq(0, 150, 20))

p10 <- ggplot(aes(x = sulphates), data = vinhos) +
    geom_histogram(binwidth = 0.02, color = 'black', fill = '#099DD9') +
    scale_x_log10(breaks = seq(0.1, 2, 0.2))

grid.arrange(p1, p2, p4, p5, p6, p7, p10, ncol = 1)

```


# Análise Univariada

### Qual é a estrutura do conjunto de dados?
```{r}
str(vinhos)
```
Adicional ao que é exibido na função str(), de acordo com o arquivo *wineQualytiInfo.txt* obtido do repositório da Udacity no endereço https://s3.amazonaws.com/udacity-hosted-downloads/ud651/wineQualityInfo.txt, o conjunto de dados tem a seguinte estrutura de variáveis:

**Input variables (based on physicochemical tests):**

1. **fixed acidity** (tartaric acid - g / dm^3)
2. **volatile acidity** (acetic acid - g / dm^3)
3. **citric acid** (g / dm^3)
4. **residual sugar** (g / dm^3)
5. **chlorides** (sodium chloride - g / dm^3
6. **free sulfur dioxide** (mg / dm^3)
7. **total sulfur dioxide** (mg / dm^3)
8. **density** (g / cm^3)
9. **pH**
10. **sulphates** (potassium sulphate - g / dm3)
11. **alcohol** (% by volume)
   
**Output variable (based on sensory data): **

12. **quality** (score between 0 and 10)

### Quais são os principais atributos de interesse deste conjunto de dados?

**QUALITY** é o atributo principal, pois ele define a qualidade do vinho baseado nos outros fatores.

**ALCOHOL** porque o teor alcoólico também influencia no paladar;
```{r}
summary(vinhos$quality)
summary(vinhos$alcohol)
```

#### Analisando a distribuição das duas variáveis escolhidas como principais
```{r}
ggplot(aes(x = quality), data = vinhos) +
    geom_histogram(color = 'black', fill = '#099DD9', binwidth = 1) +
    scale_x_continuous(breaks = seq(0, 10, 1), limits = c(0, 10))

ggplot(aes(x = alcohol), data = vinhos) +
    geom_histogram(color = 'black', fill = '#099DD9', binwidth = 0.5) +
    scale_x_continuous(breaks = seq(8, 15, 0.5), limits = c(8, 15))
```

#### Criando uma variável de categoria para agrupar qualidades de vinhos
Dado que a variável *quality* apresenta apenas números inteiros, ou seja, não teremos vinhos classificados com qualidade 6.8, por exemplo, serão criados grupos de qualidade.

1. **Péssimo** -> de 1 a 2
2. **Ruim** -> de 3 a 4
3. **Mediano** -> de 5 a 6
4. **Bom** -> de 7 a 8
5. **Ótimo** -> de 9 a 10

```{r}
# Criando os grupos de qualidade
quality.group <- c(0, 2, 4, 6, 8, 10)

# Criando rótulos para os intervalos
group <- c('Pessimo', 'Ruim', 'Mediano', 'Bom', 'Otimo')

# Classificando os vinhos de acordo com os grupos criados
vinhos$class <- cut(vinhos$quality, quality.group, include.lowest = TRUE, right = FALSE, labels = group)
```


### Quais outros atributos você acha que podem lhe auxiliar na investigação destes atributos de interesse?

**DENSITY** porque pode refletir diretamente na sensação ao degustar o produto;

**PH** porque indica o nível de acidez sentido pelo apreciador do vinho;
```{r}
summary(vinhos$density)
summary(vinhos$pH)
```

### Você criou novas variáveis a partir dos atributos existentes no conjunto de dados?
Foi criada a variável **class**, conforme descrito acima para classificar os vinhos em péssimos, ruins, medianos, bons e ótimos.

### Dos atributos investigados, distribuições incomuns foram encontradas? Você aplicou operações nos dados para limpá-los, ajustá-los ou mudar a forma dos dados? Se sim, por quê?

# Seção de Gráficos Bivariados
```{r echo=FALSE, Bivariate_Plots}

```

# Análise Bivariada

### Discuta sobre alguns dos relacionamentos observados nesta parte da investigação. Como os atributos de interesse variaram no conjunto de dados?

### Você observou algum relacionamento interessante entre os outros atributos (os que não são de interesse)?

### Qual foi o relacionamento mais forte encontrado?




# Seção de Gráficos Multivariados

```{r echo=FALSE, Multivariate_Plots}

```

# Análise Multivariada

### Discuta sobre os relacionamentos observados nesta parte da investigação. Quais atributos que fortaleceram os demais na observação das variáveis de interesse?

### Interações surpreendentes e/ou interessantes foram encontradas entre os atributos?

### OPCIONAL: Modelos foram criados usando este conjunto de dados? Discuta sobre os pontos fortes e as limitações do seu modelo.

------

# Gráficos Finais e Sumário

### Primeiro Gráfico
```{r echo=FALSE, Plot_One}

```

### Descrição do Primeiro Gráfico


### Segundo Gráfico
```{r echo=FALSE, Plot_Two}

```

### Descrição do Segundo Gráfico


### Terceiro Gráfico
```{r echo=FALSE, Plot_Three}

```

### Descrição do Terceiro Gráfico

------

# Reflexão


